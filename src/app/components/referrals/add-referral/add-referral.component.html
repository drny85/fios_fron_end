<div class="">
  <h2 class="center">Add New Referral</h2>
  <div class="card grey lighten-5 animated fadeInDown">
    <form no id="form" #myForm="ngForm" (ngSubmit)="onSubmit(myForm)">
      <div class="row">
        <div class="input-field col s6">
          <input type="text" id="name" [(ngModel)]="referral.name" #ref_name="ngModel" required name="name" class="" />
          <label for="name">Name</label>
          <p class="red-text" *ngIf="
              ref_name.touched && ref_name.invalid && ref_name.errors?.required
            ">
            Name required
          </p>
        </div>
        <div class="input-field col s6">
          <input type="text" id="last_name" [(ngModel)]="referral.last_name" #ref_last_name="ngModel" required name="last_name"
            class="" />
          <label for="last_name">Last Name</label>
          <p class="red-text" *ngIf="
              ref_last_name.touched &&
              ref_last_name.invalid &&
              ref_last_name.errors?.required
            ">
            Last name is required
          </p>
        </div>
      </div>

      <div class="row">
        <div class="input-field col s12 l4">
          <input type="text" id="address" [(ngModel)]="referral.address.address" #ref_address.address="ngModel" name="address"
            required class="validate" />
          <label for="address">Address</label>
        </div>

        <div class="input-field col s12 l4">
          <input type="text" id="apt" [(ngModel)]="referral.address.apt" #ref_apt="ngModel" name="apt" class="validate" />
          <label for="apt">Apt</label>
        </div>

        <div class="input-field col s12 l4">
          <input type="text" id="zipcode" [(ngModel)]="referral.address.zipcode" #ref_zipcode="ngModel" (keyup)="populateCity(ref_zipcode)"
            name="zipcode" maxlength="5" minlength="5" required class="validate" />
          <label for="zipcode">Zip code</label>
        </div>
      </div>

      <div class="row">
        <div class="input-field col s12 l4">
          <input type="text" id="city" [(ngModel)]="referral.address.city" #ref_city="ngModel" name="city" required
            class="validate" />
          <label for="city">City</label>
        </div>

        <div class="input-field col s12 l4">
          <input type="tel" id="phone" [(ngModel)]="referral.phone" #ref_phone="ngModel" (blur)="formatPhone(ref_phone)"
            minlength="10" required name="phone" class="validate" />
          <label for="phone">Phone</label>
        </div>

        <div class="input-field col s12 l4">
          <input type="email" id="email" [(ngModel)]="referral.email" #ref_email="ngModel" email name="email" class="validate" />
          <label for="city">Email</label>
        </div>
      </div>

      <div class="row">
        <div class="input-field col s12 l4">
          <input type="date" [(ngModel)]="referral.moveIn" #ref_moveIn="ngModel" name="moveIn" id="moveIn" required />
          <label for="moveIn">Move In</label>
        </div>
        <div class="input-field mat-form col s12 l4">
          <mat-form-field>
            <mat-select class="capitalized" [(ngModel)]="referral.referralBy" #ref_referralBy="ngModel" placeholder="Referral By"
              name="referralBy">
              <mat-option selected value=""> Select a referee</mat-option>
              <mat-option class="capitalized" *ngFor="let referee of referees.referees" [value]="referee._id">
                {{ referee.name }} {{ referee.last_name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="input-field mat-form col s12 l4">
          <mat-form-field>
            <mat-select name="status" placeholder="Status" id="status" class="validate" [(ngModel)]="referral.status"
              #ref_atatus="ngModel" required>
              <mat-option value="new">New</mat-option>
              <mat-option value="closed">Closed</mat-option>
              <mat-option value="in progress">In Progress</mat-option>
              <mat-option value="pending">Pending</mat-option>
              <mat-option value="not sold">Not Sold</mat-option>
            </mat-select>
          </mat-form-field>

        </div>
        <div class="row">
          <div class="input-field col s12">
            <textarea id="comment" name="comment" [(ngModel)]="referral.comment" #ref_comment="ngModel" class="materialize-textarea"></textarea>
            <label for="comment">Notes or Comments</label>
          </div>
        </div>
      </div>

      <div>
        <button id="btn-submit" [disabled]="!myForm.valid" class="btn black waves-effect waves-light" type="submit">
          Submit
        </button>
      </div>
      <br />
    </form>
  </div>
  {{ referral | json }} {{ myForm.valid }}
</div>
